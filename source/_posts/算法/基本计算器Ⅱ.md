---
title: 基本计算器Ⅱ
category: 算法
excerpt: 这一题用来处理算式相关字符串的方法值得细细品味.
---

[leetcode227 基本计算器Ⅱ](https://leetcode.cn/problems/basic-calculator-ii/)

遇到算式一类问题,可以优先考虑用栈

思路:

1. 先计算乘除的结果,再计算加减的结果
2. 进一步优化: 将负号融入数字,将乘除的结果看成一个数字,这样整个字符串最后就变成了多个数字相加
3. 过程:
   - 如果当前数字的前导符号是+,则将其入栈
   - 如果当前数字的前导符号是-,则将其**相反数**入栈
   - 如果当前数字的前导符号是*,则将**栈顶元素取出与当前数字相乘**,然后入栈
   - 如果当前数字的前导符号是/,则将**栈顶元素取出与当前数字相除**,然后入栈
   - 最后将栈中所有数字相加即是结果
4. 注:第一个数字的前导符号视为加号

```java
class Solution {
    public int calculate(String s) {
        Stack<Integer>st=new Stack<>();
        char[]chs=s.toCharArray();
        int t=0;    //临时存储数字
        char preOps='+';
        for(int i=0;i<s.length();i++){
            if(Character.isDigit(chs[i])){
                t*=10;
                t+=chs[i]-'0';
            }
            if(!Character.isDigit(chs[i]) && chs[i]!=' ' || i==s.length()-1)
            {
                if(preOps=='+')
                    st.push(t);
                else if(preOps=='-')
                    st.push(-t);
                else if(preOps=='*'){
                    st.push(st.pop()*t);
                }else
                    st.push(st.pop()/t);
                preOps=chs[i];
                t=0;    //刷新数字
            }
        }    
        int ans=0;
        while(!st.isEmpty()){
            ans+=st.pop();
        }
        return ans;
    }
}



```

